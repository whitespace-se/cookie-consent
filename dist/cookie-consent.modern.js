import e from"react";import t from"react-dom";import n from"classnames";function o({namespace:t="cookie-consent",title:o,children:r,allowButtonLabel:i,denyButtonLabel:s,onAllow:c,onDeny:a,position:l,contentRef:u,className:p,...d}){return e.createElement("div",Object.assign({className:n(""+t,l&&`${t}--${l}`,p),role:"region","aria-live":"polite","aria-labelledby":t+"-title","aria-describedby":t+"-description"},d),e.createElement("div",{role:"document",className:t+"__container",tabIndex:"0",ref:u},e.createElement("h2",{id:t+"-title",className:t+"__title"},o),e.createElement("div",{id:t+"-description",className:t+"__description"},r),e.createElement("div",{className:t+"__button-group"},s&&e.createElement("button",{className:`${t}__button ${t}__button--deny`,type:"button",onClick:a},s),i&&e.createElement("button",{className:`${t}__button ${t}__button--allow`,type:"button",onClick:c},i))))}function r({namespace:t="cookie-consent",i18n:r,answer:i,setAnswer:s,constants:{ALLOW:c,DENY:a},text:l,...u}){return i?null:e.createElement(o,Object.assign({namespace:t,onAllow:()=>s(c),onDeny:()=>s(a),title:r("title"),allowButtonLabel:r("allow"),denyButtonLabel:r("deny")},u),l||e.createElement("p",null,r("text")," ",e.createElement("a",{href:r("readMoreURL"),className:n(t+"__more")},r("readMore"))))}function i(e,t){if(t.length<e)throw new TypeError(e+" argument"+(e>1?"s":"")+" required, but only "+t.length+" present")}function s(e){i(1,arguments);var t=Object.prototype.toString.call(e);return e instanceof Date||"object"==typeof e&&"[object Date]"===t?new Date(e.getTime()):"number"==typeof e||"[object Number]"===t?new Date(e):("string"!=typeof e&&"[object String]"!==t||"undefined"==typeof console||(console.warn("Starting with v2.0.0-beta.1 date-fns doesn't accept strings as arguments. Please use `parseISO` to parse strings. See: https://git.io/fjule"),console.warn((new Error).stack)),new Date(NaN))}function c(e,t){i(2,arguments);var n=s(e),o=s(t),r=n.getFullYear()-o.getFullYear(),c=n.getMonth()-o.getMonth();return 12*r+c}function a(e,t){i(2,arguments);var n=s(e),o=s(t),r=n.getTime()-o.getTime();return r<0?-1:r>0?1:r}const l={blacklist:window.YETT_BLACKLIST,whitelist:window.YETT_WHITELIST},u={blacklisted:[]},p=(e,t)=>e&&(!t||"javascript/blocked"!==t)&&(!l.blacklist||l.blacklist.some(t=>t.test(e)))&&(!l.whitelist||l.whitelist.every(t=>!t.test(e))),d=function(e){const t=e.getAttribute("src");return l.blacklist&&l.blacklist.every(e=>!e.test(t))||l.whitelist&&l.whitelist.some(e=>e.test(t))},m=new MutationObserver(e=>{for(let t=0;t<e.length;t++){const{addedNodes:n}=e[t];for(let e=0;e<n.length;e++){const t=n[e];if(1===t.nodeType&&"SCRIPT"===t.tagName&&p(t.src,t.type)){u.blacklisted.push([t,t.type]),t.type="javascript/blocked";const e=function(n){"javascript/blocked"===t.getAttribute("type")&&n.preventDefault(),t.removeEventListener("beforescriptexecute",e)};t.addEventListener("beforescriptexecute",e),t.parentElement&&t.parentElement.removeChild(t)}}}}),b=document.createElement,w={src:Object.getOwnPropertyDescriptor(HTMLScriptElement.prototype,"src"),type:Object.getOwnPropertyDescriptor(HTMLScriptElement.prototype,"type")},f=new RegExp("[|\\{}()[\\]^$+*?.]","g");let g,h,y,k,v,E,L,S,j,O={en:{title:"This web site uses cookies",text:"We use cookies in order to enrich and personalize your experience, understand traffic and target ads. You can approve the default cookies, or fine tune them under Settings.",allow:"Allow",deny:"Deny",readMore:"Read more about cookies",readMoreURL:"/about-cookies"},sv:{title:"Vår webbplats använder cookies",text:"Vi använder cookies för att förbättra din upplevelse, analysera trafik och anpassa marknadsföring. Godkänn våra cookies eller finjustera under Inställningar.",allow:"Tillåt",deny:"Neka",readMore:"Läs mer om cookies",readMoreURL:"/om-cookies"}},_=!1,N=e.createRef();const A="whitespace/cookie-consent",D="allow",T="deny";function x(e,t){g=e.whitelist||[],h=e.resetElement||".js-cookie-consent-reset";let n=e.currentLanguage||"en";k={...O[n]||O.en,...e.messages&&e.messages[n]||{}},v=e.onAnswer||(()=>{}),E=e.onAllow||(()=>{}),L=e.onDeny||(()=>{}),S=e.onUnblockScripts||(()=>{}),j={namespace:e.namespace||"cookie-consent",position:e.position||"bottom-left",...e.componentProps},"allow"!==$()&&(_||(window.location.origin&&g.push(window.location.origin+"/*"),g=g.map(function(e){return new RegExp(`^${e.replace(/[.+?^${}()|[\]\\]/g,"\\$&").replace(/\*/g,".*")}$`)}),function({blacklist:e,whitelist:t}={}){l.blacklist=(l.blacklist||e)&&[...l.blacklist||[],...e||[]],l.whitelist=(l.whitelist||t)&&[...l.whitelist||[],...t||[]],m.observe(document.documentElement,{childList:!0,subtree:!0}),document.createElement=function(...e){if("script"!==e[0].toLowerCase())return b.bind(document)(...e);const t=b.bind(document)(...e);try{Object.defineProperties(t,{src:{get(){return w.src.get.call(this)},set(e){p(e,t.type)&&w.type.set.call(this,"javascript/blocked"),w.src.set.call(this,e)}},type:{set(e){const n=p(t.src,t.type)?"javascript/blocked":e;w.type.set.call(this,n)}}}),t.setAttribute=function(e,n){"type"===e||"src"===e?t[e]=n:HTMLScriptElement.prototype.setAttribute.call(t,e,n)}}catch(e){console.warn("Yett: unable to prevent script execution for script src ",t.src,".\n",'A likely cause would be because you are using a third-party browser extension that monkey patches the "document.createElement" function.')}return t}}({whitelist:g}),_=!0)),document.addEventListener("DOMContentLoaded",function(){y||(y=document.createElement("div"),document.body.appendChild(y)),function(){let e=B(h);e&&e.addEventListener("click",()=>{W()})}(),P(t)}),window.addEventListener("storage",e=>{null!=e.key&&"whitespace/cookie-consent"!==e.key||I()})}const M={answer:null,answeredOn:null};function R(e,t){localStorage.setItem("whitespace/cookie-consent",JSON.stringify(e)),I(t)}function $(){const{answer:e,answeredOn:t}=function(){let e=localStorage.getItem("whitespace/cookie-consent");if(e)try{return JSON.parse(e)||M}catch{return M}return M}();return null!=e&&function(e,t){i(2,arguments);var n=s(e),o=s(t),r=a(n,o),l=Math.abs(c(n,o));n.setMonth(n.getMonth()-r*l);var u=a(n,o)===-r,p=r*(l-u);return 0===p?0:p}(new Date,new Date(t))<12?e:null}function C(e,t){R({answer:e,answeredOn:(new Date).toISOString()},t),v(e),"allow"===e?E():null!=e&&L()}function I(e){"allow"===$()&&(_&&(function(...e){e.length<1?(l.blacklist=[],l.whitelist=[]):(l.blacklist&&(l.blacklist=l.blacklist.filter(t=>e.every(e=>"string"==typeof e?!t.test(e):e instanceof RegExp?t.toString()!==e.toString():void 0))),l.whitelist&&(l.whitelist=[...l.whitelist,...e.map(e=>{if("string"==typeof e){const t=".*"+e.replace(f,"\\$&")+".*";if(l.whitelist.every(e=>e.toString()!==t.toString()))return new RegExp(t)}else if(e instanceof RegExp&&l.whitelist.every(t=>t.toString()!==e.toString()))return e;return null}).filter(Boolean)]));const t=document.querySelectorAll('script[type="javascript/blocked"]');for(let e=0;e<t.length;e++){const n=t[e];d(n)&&(u.blacklisted.push([n,"application/javascript"]),n.parentElement.removeChild(n))}let n=0;[...u.blacklisted].forEach(([e,t],o)=>{if(d(e)){const r=document.createElement("script");r.setAttribute("src",e.src),r.setAttribute("type",t||"application/javascript");for(let t in e)t.startsWith("on")&&(r[t]=e[t]);document.head.appendChild(r),u.blacklisted.splice(o-n,1),n++}}),l.blacklist&&l.blacklist.length<1&&m.disconnect()}(),_=!1),S()),P(e)}function Y(e){return k[e]}function B(e){return"string"==typeof e?document.querySelector(e):e}function P(n){t.render(e.createElement(r,Object.assign({i18n:Y,answer:$(),setAnswer:C,constants:{ALLOW:"allow",DENY:"deny"},contentRef:N},j)),B(y),n)}function W(){R(null,()=>{N.current&&N.current.focus()})}export{D as ALLOW,T as DENY,A as LOCALSTORAGE_ITEM,x as init,W as reset,C as setAnswer};
//# sourceMappingURL=cookie-consent.modern.js.map
