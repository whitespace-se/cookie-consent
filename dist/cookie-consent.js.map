{"version":3,"file":"cookie-consent.js","sources":["../src/components/CookieConsentDialog.js","../src/components/CookieConsentContainer.js","../node_modules/date-fns/esm/_lib/requiredArgs/index.js","../node_modules/date-fns/esm/toDate/index.js","../node_modules/date-fns/esm/differenceInCalendarMonths/index.js","../node_modules/date-fns/esm/compareAsc/index.js","../src/cookie-consent.js","../src/yett/src/variables.js","../src/yett/src/checks.js","../src/yett/src/observer.js","../src/yett/src/monkey.js","../src/yett/src/unblock.js","../node_modules/date-fns/esm/differenceInMonths/index.js","../src/yett/src/index.js"],"sourcesContent":["import React from \"react\";\nimport cx from \"classnames\";\n\n{\n  /* <p id={`${ns}-description`} className={`${ns}__description`}>\n{description}{\" \"}\n{morelink && morelink.url ? (\n  <Link className={cx(`${ns}__more`)} to={morelink.url}>\n    {morelink.text}\n  </Link>\n) : null}\n</p> */\n}\n\nexport default function CookieConsentDialog({\n  namespace: ns = \"cookie-consent\",\n  title,\n  children,\n  allowButtonLabel,\n  denyButtonLabel,\n  onAllow,\n  onDeny,\n  position,\n  contentRef,\n  className,\n  ...restProps\n}) {\n  return (\n    <div\n      className={cx(`${ns}`, position && `${ns}--${position}`, className)}\n      role=\"region\"\n      aria-live=\"polite\"\n      aria-labelledby={`${ns}-title`}\n      aria-describedby={`${ns}-description`}\n      {...restProps}\n    >\n      <div\n        role=\"document\"\n        className={`${ns}__container`}\n        tabIndex=\"0\"\n        ref={contentRef}\n      >\n        <h2 id={`${ns}-title`} className={`${ns}__title`}>\n          {title}\n        </h2>\n        <div id={`${ns}-description`} className={`${ns}__description`}>\n          {children}\n        </div>\n\n        <div className={`${ns}__button-group`}>\n          {denyButtonLabel && (\n            <button\n              className={`${ns}__button ${ns}__button--deny`}\n              type=\"button\"\n              onClick={onDeny}\n            >\n              {denyButtonLabel}\n            </button>\n          )}\n          {allowButtonLabel && (\n            <button\n              className={`${ns}__button ${ns}__button--allow`}\n              type=\"button\"\n              onClick={onAllow}\n            >\n              {allowButtonLabel}\n            </button>\n          )}\n        </div>\n      </div>\n    </div>\n  );\n}\n","import React from \"react\";\nimport cx from \"classnames\";\n\nimport CookieConsentDialog from \"./CookieConsentDialog\";\n\nexport default function CookieConsentContainer({\n  namespace: ns = \"cookie-consent\",\n  i18n,\n  answer,\n  setAnswer,\n  constants: { ALLOW, DENY },\n  text,\n  ...restProps\n}) {\n  if (answer) {\n    return null;\n  }\n  return (\n    <CookieConsentDialog\n      namespace={ns}\n      onAllow={() => setAnswer(ALLOW)}\n      onDeny={() => setAnswer(DENY)}\n      title={i18n(\"title\")}\n      allowButtonLabel={i18n(\"allow\")}\n      denyButtonLabel={i18n(\"deny\")}\n      {...restProps}\n    >\n      {text || (\n        <p>\n          {i18n(\"text\")}{\" \"}\n          <a href={i18n(\"readMoreURL\")} className={cx(`${ns}__more`)}>\n            {i18n(\"readMore\")}\n          </a>\n        </p>\n      )}\n    </CookieConsentDialog>\n  );\n}\n","export default function requiredArgs(required, args) {\n  if (args.length < required) {\n    throw new TypeError(required + ' argument' + (required > 1 ? 's' : '') + ' required, but only ' + args.length + ' present');\n  }\n}","import requiredArgs from '../_lib/requiredArgs/index.js';\n/**\n * @name toDate\n * @category Common Helpers\n * @summary Convert the given argument to an instance of Date.\n *\n * @description\n * Convert the given argument to an instance of Date.\n *\n * If the argument is an instance of Date, the function returns its clone.\n *\n * If the argument is a number, it is treated as a timestamp.\n *\n * If the argument is none of the above, the function returns Invalid Date.\n *\n * **Note**: *all* Date arguments passed to any *date-fns* function is processed by `toDate`.\n *\n * @param {Date|Number} argument - the value to convert\n * @returns {Date} the parsed date in the local time zone\n * @throws {TypeError} 1 argument required\n *\n * @example\n * // Clone the date:\n * const result = toDate(new Date(2014, 1, 11, 11, 30, 30))\n * //=> Tue Feb 11 2014 11:30:30\n *\n * @example\n * // Convert the timestamp to date:\n * const result = toDate(1392098430000)\n * //=> Tue Feb 11 2014 11:30:30\n */\n\nexport default function toDate(argument) {\n  requiredArgs(1, arguments);\n  var argStr = Object.prototype.toString.call(argument); // Clone the date\n\n  if (argument instanceof Date || typeof argument === 'object' && argStr === '[object Date]') {\n    // Prevent the date to lose the milliseconds when passed to new Date() in IE10\n    return new Date(argument.getTime());\n  } else if (typeof argument === 'number' || argStr === '[object Number]') {\n    return new Date(argument);\n  } else {\n    if ((typeof argument === 'string' || argStr === '[object String]') && typeof console !== 'undefined') {\n      // eslint-disable-next-line no-console\n      console.warn(\"Starting with v2.0.0-beta.1 date-fns doesn't accept strings as arguments. Please use `parseISO` to parse strings. See: https://git.io/fjule\"); // eslint-disable-next-line no-console\n\n      console.warn(new Error().stack);\n    }\n\n    return new Date(NaN);\n  }\n}","import toDate from '../toDate/index.js';\nimport requiredArgs from '../_lib/requiredArgs/index.js';\n/**\n * @name differenceInCalendarMonths\n * @category Month Helpers\n * @summary Get the number of calendar months between the given dates.\n *\n * @description\n * Get the number of calendar months between the given dates.\n *\n * ### v2.0.0 breaking changes:\n *\n * - [Changes that are common for the whole library](https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#Common-Changes).\n *\n * @param {Date|Number} dateLeft - the later date\n * @param {Date|Number} dateRight - the earlier date\n * @returns {Number} the number of calendar months\n * @throws {TypeError} 2 arguments required\n *\n * @example\n * // How many calendar months are between 31 January 2014 and 1 September 2014?\n * var result = differenceInCalendarMonths(\n *   new Date(2014, 8, 1),\n *   new Date(2014, 0, 31)\n * )\n * //=> 8\n */\n\nexport default function differenceInCalendarMonths(dirtyDateLeft, dirtyDateRight) {\n  requiredArgs(2, arguments);\n  var dateLeft = toDate(dirtyDateLeft);\n  var dateRight = toDate(dirtyDateRight);\n  var yearDiff = dateLeft.getFullYear() - dateRight.getFullYear();\n  var monthDiff = dateLeft.getMonth() - dateRight.getMonth();\n  return yearDiff * 12 + monthDiff;\n}","import toDate from '../toDate/index.js';\nimport requiredArgs from '../_lib/requiredArgs/index.js';\n/**\n * @name compareAsc\n * @category Common Helpers\n * @summary Compare the two dates and return -1, 0 or 1.\n *\n * @description\n * Compare the two dates and return 1 if the first date is after the second,\n * -1 if the first date is before the second or 0 if dates are equal.\n *\n * ### v2.0.0 breaking changes:\n *\n * - [Changes that are common for the whole library](https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#Common-Changes).\n *\n * @param {Date|Number} dateLeft - the first date to compare\n * @param {Date|Number} dateRight - the second date to compare\n * @returns {Number} the result of the comparison\n * @throws {TypeError} 2 arguments required\n *\n * @example\n * // Compare 11 February 1987 and 10 July 1989:\n * var result = compareAsc(new Date(1987, 1, 11), new Date(1989, 6, 10))\n * //=> -1\n *\n * @example\n * // Sort the array of dates:\n * var result = [\n *   new Date(1995, 6, 2),\n *   new Date(1987, 1, 11),\n *   new Date(1989, 6, 10)\n * ].sort(compareAsc)\n * //=> [\n * //   Wed Feb 11 1987 00:00:00,\n * //   Mon Jul 10 1989 00:00:00,\n * //   Sun Jul 02 1995 00:00:00\n * // ]\n */\n\nexport default function compareAsc(dirtyDateLeft, dirtyDateRight) {\n  requiredArgs(2, arguments);\n  var dateLeft = toDate(dirtyDateLeft);\n  var dateRight = toDate(dirtyDateRight);\n  var diff = dateLeft.getTime() - dateRight.getTime();\n\n  if (diff < 0) {\n    return -1;\n  } else if (diff > 0) {\n    return 1; // Return 0 if diff is 0; return NaN if diff is NaN\n  } else {\n    return diff;\n  }\n}","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport en from \"./messages/en.json\";\nimport sv from \"./messages/sv.json\";\nimport CookieConsentContainer from \"./components/CookieConsentContainer\";\nimport differenceInMonths from \"date-fns/differenceInMonths\";\nimport * as yett from \"./yett/src\";\n\nlet whitelist;\nlet resetElementSelector;\nlet dialogContainerSelector;\nlet defaultMessages = { en, sv };\nlet messages;\nlet blocked = false;\nlet onAnswer;\nlet onAllow;\nlet onDeny;\nlet onUnblockScripts;\nlet componentProps;\nlet dialogContentRef = React.createRef();\n\nconst LOCALSTORAGE_ITEM = \"whitespace/cookie-consent\";\nconst ALLOW = \"allow\";\nconst DENY = \"deny\";\nconst DEFAULT_RESET_SELECTOR = \".js-cookie-consent-reset\";\nconst DEFAULT_LANG = \"en\";\n\nfunction init(options, callback) {\n  whitelist = options.whitelist || [];\n  resetElementSelector = options.resetElement || DEFAULT_RESET_SELECTOR;\n  let currentLanguage = options.currentLanguage || DEFAULT_LANG;\n  messages = {\n    ...(defaultMessages[currentLanguage] || defaultMessages[DEFAULT_LANG]),\n    ...((options.messages && options.messages[currentLanguage]) || {}),\n  };\n  onAnswer = options.onAnswer || (() => {});\n  onAllow = options.onAllow || (() => {});\n  onDeny = options.onDeny || (() => {});\n  onUnblockScripts = options.onUnblockScripts || (() => {});\n  componentProps = {\n    namespace: options.namespace || \"cookie-consent\",\n    position: options.position || \"bottom-left\",\n    ...options.componentProps,\n  };\n  let answer = getAnswer();\n  if (answer !== ALLOW) {\n    blockScripts();\n  }\n  document.addEventListener(\"DOMContentLoaded\", function () {\n    if (!dialogContainerSelector) {\n      dialogContainerSelector = document.createElement(\"div\");\n      document.body.appendChild(dialogContainerSelector);\n    }\n    bindResetElement();\n    renderDialog(callback);\n  });\n  window.addEventListener(\"storage\", (event) => {\n    if (event.key == null || event.key === LOCALSTORAGE_ITEM) {\n      onStoreUpdate();\n    }\n  });\n}\n\nconst defaultStore = {\n  answer: null,\n  answeredOn: null,\n};\n\nfunction getStore() {\n  let savedStore = localStorage.getItem(LOCALSTORAGE_ITEM);\n  if (savedStore) {\n    try {\n      return JSON.parse(savedStore) || defaultStore;\n    } catch {\n      return defaultStore;\n    }\n  }\n  return defaultStore;\n}\n\nfunction setStore(value, callback) {\n  localStorage.setItem(LOCALSTORAGE_ITEM, JSON.stringify(value));\n  onStoreUpdate(callback);\n}\n\nfunction getAnswer() {\n  const { answer, answeredOn } = getStore();\n  if (\n    answer != null &&\n    differenceInMonths(new Date(), new Date(answeredOn)) < 12\n  ) {\n    return answer;\n  }\n  return null;\n}\n\nfunction setAnswer(answer, callback) {\n  setStore(\n    {\n      answer,\n      answeredOn: new Date().toISOString(),\n    },\n    callback,\n  );\n  onAnswer(answer);\n  if (answer === ALLOW) {\n    onAllow();\n  } else if (answer != null) {\n    onDeny();\n  }\n}\n\nfunction onStoreUpdate(callback) {\n  let answer = getAnswer();\n  if (answer === ALLOW) {\n    unblockScripts();\n    onUnblockScripts();\n  }\n  renderDialog(callback);\n}\n\nfunction blockScripts() {\n  if (blocked) {\n    return;\n  }\n\n  // add current origin to whitelist\n  if (window.location.origin) {\n    whitelist.push(`${window.location.origin}/*`);\n  }\n\n  //convert strings to regex and escape special characters\n  whitelist = whitelist.map(function (domain) {\n    return new RegExp(\n      `^${domain.replace(/[.+?^${}()|[\\]\\\\]/g, \"\\\\$&\").replace(/\\*/g, \".*\")}$`,\n    );\n  });\n\n\n  yett.init({ whitelist });\n\n  blocked = true;\n}\n\nfunction unblockScripts() {\n  if (!blocked) {\n    return;\n  }\n  yett.unblock();\n  blocked = false;\n}\n\nfunction i18n(key) {\n  return messages[key];\n}\n\nfunction getElement(selectorOrElement) {\n  if (typeof selectorOrElement === \"string\") {\n    return document.querySelector(selectorOrElement);\n  }\n  return selectorOrElement;\n}\n\nfunction getDialogContainer() {\n  return getElement(dialogContainerSelector);\n}\n\nfunction getResetElement() {\n  return getElement(resetElementSelector);\n}\n\nfunction renderDialog(callback) {\n  ReactDOM.render(\n    <CookieConsentContainer\n      i18n={i18n}\n      answer={getAnswer()}\n      setAnswer={setAnswer}\n      constants={{ ALLOW, DENY }}\n      contentRef={dialogContentRef}\n      {...componentProps}\n    />,\n    getDialogContainer(),\n    callback,\n  );\n}\n\nfunction bindResetElement() {\n  let element = getResetElement();\n  if (element) {\n    element.addEventListener(\"click\", () => {\n      reset();\n    });\n  }\n}\n\nfunction reset() {\n  setStore(null, () => {\n    if (dialogContentRef.current) {\n      dialogContentRef.current.focus();\n    }\n  });\n}\n\nexport { init, reset, setAnswer, ALLOW, DENY, LOCALSTORAGE_ITEM };\n","export const TYPE_ATTRIBUTE = \"javascript/blocked\";\n\nexport const patterns = {\n  blacklist: window.YETT_BLACKLIST,\n  whitelist: window.YETT_WHITELIST,\n};\n\n// Backup list containing the original blacklisted script elements\nexport const backupScripts = {\n  blacklisted: [],\n};\n","import { patterns, TYPE_ATTRIBUTE } from \"./variables\";\n\nexport const isOnBlacklist = (src, type) =>\n  src &&\n  (!type || type !== TYPE_ATTRIBUTE) &&\n  (!patterns.blacklist ||\n    patterns.blacklist.some((pattern) => pattern.test(src))) &&\n  (!patterns.whitelist ||\n    patterns.whitelist.every((pattern) => !pattern.test(src)));\n\nexport const willBeUnblocked = function (script) {\n  const src = script.getAttribute(\"src\");\n  return (\n    (patterns.blacklist &&\n      patterns.blacklist.every((entry) => !entry.test(src))) ||\n    (patterns.whitelist && patterns.whitelist.some((entry) => entry.test(src)))\n  );\n};\n","import { backupScripts, TYPE_ATTRIBUTE } from \"./variables\";\nimport { isOnBlacklist } from \"./checks\";\n\n// Setup a mutation observer to track DOM insertion\nexport const observer = new MutationObserver((mutations) => {\n  for (let i = 0; i < mutations.length; i++) {\n    const { addedNodes } = mutations[i];\n    for (let i = 0; i < addedNodes.length; i++) {\n      const node = addedNodes[i];\n      // For each added script tag\n      if (node.nodeType === 1 && node.tagName === \"SCRIPT\") {\n        const src = node.src;\n        const type = node.type;\n        // If the src is inside the blacklist and is not inside the whitelist\n        if (isOnBlacklist(src, type)) {\n          // We backup the node\n          backupScripts.blacklisted.push([node, node.type]);\n\n          // Blocks inline script execution in Safari & Chrome\n          node.type = TYPE_ATTRIBUTE;\n\n          // Firefox has this additional event which prevents scripts from beeing executed\n          const beforeScriptExecuteListener = function (event) {\n            // Prevent only marked scripts from executing\n            if (node.getAttribute(\"type\") === TYPE_ATTRIBUTE)\n              event.preventDefault();\n            node.removeEventListener(\n              \"beforescriptexecute\",\n              beforeScriptExecuteListener,\n            );\n          };\n          node.addEventListener(\n            \"beforescriptexecute\",\n            beforeScriptExecuteListener,\n          );\n\n          // Remove the node from the DOM\n          node.parentElement && node.parentElement.removeChild(node);\n        }\n      }\n    }\n  }\n});\n\nexport function observe() {\n  // Starts the monitoring\n  observer.observe(document.documentElement, {\n    childList: true,\n    subtree: true,\n  });\n}\n","import { TYPE_ATTRIBUTE } from \"./variables\";\nimport { isOnBlacklist } from \"./checks\";\n\nconst createElementBackup = document.createElement;\n\nconst originalDescriptors = {\n  src: Object.getOwnPropertyDescriptor(HTMLScriptElement.prototype, \"src\"),\n  type: Object.getOwnPropertyDescriptor(HTMLScriptElement.prototype, \"type\"),\n};\n\nexport function monkey() {\n  // Monkey patch the createElement method to prevent dynamic scripts from executing\n  document.createElement = function (...args) {\n    // If this is not a script tag, bypass\n    if (args[0].toLowerCase() !== \"script\")\n      return createElementBackup.bind(document)(...args);\n\n    const scriptElt = createElementBackup.bind(document)(...args);\n\n    // Define getters / setters to ensure that the script type is properly set\n    try {\n      Object.defineProperties(scriptElt, {\n        src: {\n          get() {\n            return originalDescriptors.src.get.call(this);\n          },\n          set(value) {\n            if (isOnBlacklist(value, scriptElt.type)) {\n              originalDescriptors.type.set.call(this, TYPE_ATTRIBUTE);\n            }\n            originalDescriptors.src.set.call(this, value);\n          },\n        },\n        type: {\n          set(value) {\n            const typeValue = isOnBlacklist(scriptElt.src, scriptElt.type)\n              ? TYPE_ATTRIBUTE\n              : value;\n            originalDescriptors.type.set.call(this, typeValue);\n          },\n        },\n      });\n\n      // Monkey patch the setAttribute function so that the setter is called instead\n      scriptElt.setAttribute = function (name, value) {\n        if (name === \"type\" || name === \"src\") scriptElt[name] = value;\n        else\n          HTMLScriptElement.prototype.setAttribute.call(scriptElt, name, value);\n      };\n    } catch (error) {\n      // eslint-disable-next-line\n      console.warn(\n        \"Yett: unable to prevent script execution for script src \",\n        scriptElt.src,\n        \".\\n\",\n        'A likely cause would be because you are using a third-party browser extension that monkey patches the \"document.createElement\" function.',\n      );\n    }\n    return scriptElt;\n  };\n}\n","import { patterns, backupScripts, TYPE_ATTRIBUTE } from \"./variables\";\n\nimport { willBeUnblocked } from \"./checks\";\n\nimport { observer } from \"./observer\";\n\nconst URL_REPLACER_REGEXP = new RegExp(\"[|\\\\{}()[\\\\]^$+*?.]\", \"g\");\n\n// Unblocks all (or a selection of) blacklisted scripts.\nexport const unblock = function (...scriptUrlsOrRegexes) {\n  if (scriptUrlsOrRegexes.length < 1) {\n    patterns.blacklist = [];\n    patterns.whitelist = [];\n  } else {\n    if (patterns.blacklist) {\n      patterns.blacklist = patterns.blacklist.filter((pattern) =>\n        scriptUrlsOrRegexes.every((urlOrRegexp) => {\n          if (typeof urlOrRegexp === \"string\")\n            return !pattern.test(urlOrRegexp);\n          else if (urlOrRegexp instanceof RegExp)\n            return pattern.toString() !== urlOrRegexp.toString();\n        }),\n      );\n    }\n    if (patterns.whitelist) {\n      patterns.whitelist = [\n        ...patterns.whitelist,\n        ...scriptUrlsOrRegexes\n          .map((urlOrRegexp) => {\n            if (typeof urlOrRegexp === \"string\") {\n              const escapedUrl = urlOrRegexp.replace(\n                URL_REPLACER_REGEXP,\n                \"\\\\$&\",\n              );\n              const permissiveRegexp = \".*\" + escapedUrl + \".*\";\n              if (\n                patterns.whitelist.every(\n                  (p) => p.toString() !== permissiveRegexp.toString(),\n                )\n              ) {\n                return new RegExp(permissiveRegexp);\n              }\n            } else if (urlOrRegexp instanceof RegExp) {\n              if (\n                patterns.whitelist.every(\n                  (p) => p.toString() !== urlOrRegexp.toString(),\n                )\n              ) {\n                return urlOrRegexp;\n              }\n            }\n            return null;\n          })\n          .filter(Boolean),\n      ];\n    }\n  }\n\n  // Parse existing script tags with a marked type\n  const tags = document.querySelectorAll(`script[type=\"${TYPE_ATTRIBUTE}\"]`);\n  for (let i = 0; i < tags.length; i++) {\n    const script = tags[i];\n    if (willBeUnblocked(script)) {\n      backupScripts.blacklisted.push([script, \"application/javascript\"]);\n      script.parentElement.removeChild(script);\n    }\n  }\n\n  // Exclude 'whitelisted' scripts from the blacklist and append them to <head>\n  let indexOffset = 0;\n  [...backupScripts.blacklisted].forEach(([script, type], index) => {\n    if (willBeUnblocked(script)) {\n      const scriptNode = document.createElement(\"script\");\n      scriptNode.setAttribute(\"src\", script.src);\n      scriptNode.setAttribute(\"type\", type || \"application/javascript\");\n      for (let key in script) {\n        if (key.startsWith(\"on\")) {\n          scriptNode[key] = script[key];\n        }\n      }\n      document.head.appendChild(scriptNode);\n      backupScripts.blacklisted.splice(index - indexOffset, 1);\n      indexOffset++;\n    }\n  });\n\n  // Disconnect the observer if the blacklist is empty for performance reasons\n  if (patterns.blacklist && patterns.blacklist.length < 1) {\n    observer.disconnect();\n  }\n};\n","import toDate from '../toDate/index.js';\nimport differenceInCalendarMonths from '../differenceInCalendarMonths/index.js';\nimport compareAsc from '../compareAsc/index.js';\nimport requiredArgs from '../_lib/requiredArgs/index.js';\n/**\n * @name differenceInMonths\n * @category Month Helpers\n * @summary Get the number of full months between the given dates.\n *\n * @description\n * Get the number of full months between the given dates.\n *\n * ### v2.0.0 breaking changes:\n *\n * - [Changes that are common for the whole library](https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#Common-Changes).\n *\n * @param {Date|Number} dateLeft - the later date\n * @param {Date|Number} dateRight - the earlier date\n * @returns {Number} the number of full months\n * @throws {TypeError} 2 arguments required\n *\n * @example\n * // How many full months are between 31 January 2014 and 1 September 2014?\n * var result = differenceInMonths(new Date(2014, 8, 1), new Date(2014, 0, 31))\n * //=> 7\n */\n\nexport default function differenceInMonths(dirtyDateLeft, dirtyDateRight) {\n  requiredArgs(2, arguments);\n  var dateLeft = toDate(dirtyDateLeft);\n  var dateRight = toDate(dirtyDateRight);\n  var sign = compareAsc(dateLeft, dateRight);\n  var difference = Math.abs(differenceInCalendarMonths(dateLeft, dateRight));\n  dateLeft.setMonth(dateLeft.getMonth() - sign * difference); // Math.abs(diff in full months - diff in calendar months) === 1 if last calendar month is not full\n  // If so, result must be decreased by 1 in absolute value\n\n  var isLastMonthNotFull = compareAsc(dateLeft, dateRight) === -sign;\n  var result = sign * (difference - isLastMonthNotFull); // Prevent negative zero\n\n  return result === 0 ? 0 : result;\n}","import { patterns } from \"./variables\";\nimport { observe } from \"./observer\";\nimport { monkey } from \"./monkey\";\n\nexport { unblock } from \"./unblock\";\n\nexport function init({ blacklist, whitelist } = {}) {\n  patterns.blacklist = (patterns.blacklist || blacklist) && [\n    ...(patterns.blacklist || []),\n    ...(blacklist || []),\n  ];\n  patterns.whitelist = (patterns.whitelist || whitelist) && [\n    ...(patterns.whitelist || []),\n    ...(whitelist || []),\n  ];\n\n  observe();\n  monkey();\n}\n"],"names":["CookieConsentDialog","namespace","ns","title","children","allowButtonLabel","denyButtonLabel","onAllow","onDeny","position","contentRef","className","restProps","React","cx","role","aria-live","aria-labelledby","aria-describedby","tabIndex","ref","id","type","onClick","CookieConsentContainer","i18n","answer","setAnswer","constants","ALLOW","DENY","text","href","requiredArgs","required","args","length","TypeError","toDate","argument","arguments","argStr","Object","prototype","toString","call","Date","getTime","console","warn","Error","stack","NaN","differenceInCalendarMonths","dirtyDateLeft","dirtyDateRight","dateLeft","dateRight","yearDiff","getFullYear","monthDiff","getMonth","compareAsc","diff","whitelist","resetElementSelector","dialogContainerSelector","messages","onAnswer","onUnblockScripts","componentProps","TYPE_ATTRIBUTE","patterns","blacklist","window","YETT_BLACKLIST","YETT_WHITELIST","backupScripts","blacklisted","isOnBlacklist","src","some","pattern","test","every","willBeUnblocked","script","getAttribute","entry","observer","MutationObserver","mutations","i","addedNodes","node","nodeType","tagName","push","addEventListener","beforeScriptExecuteListener","event","preventDefault","removeEventListener","parentElement","removeChild","createElementBackup","document","createElement","originalDescriptors","getOwnPropertyDescriptor","HTMLScriptElement","URL_REPLACER_REGEXP","RegExp","defaultMessages","en","sv","blocked","dialogContentRef","createRef","defaultStore","answeredOn","setStore","value","callback","localStorage","setItem","JSON","stringify","onStoreUpdate","getAnswer","savedStore","getItem","parse","getStore","sign","difference","Math","abs","setMonth","isLastMonthNotFull","result","differenceInMonths","toISOString","scriptUrlsOrRegexes","filter","urlOrRegexp","map","permissiveRegexp","replace","p","Boolean","tags","querySelectorAll","indexOffset","forEach","index","scriptNode","key","setAttribute","startsWith","head","appendChild","splice","disconnect","yett","renderDialog","getElement","selectorOrElement","querySelector","ReactDOM","render","reset","current","focus","options","resetElement","currentLanguage","location","origin","observe","documentElement","childList","subtree","toLowerCase","bind","scriptElt","defineProperties","get","this","set","typeValue","name","error","domain","element","body"],"mappings":"ifAcwBA,aACtBC,UAAWC,aAAK,mBAChBC,IAAAA,MACAC,IAAAA,SACAC,IAAAA,iBACAC,IAAAA,gBACAC,IAAAA,QACAC,IAAAA,OACAC,IAAAA,SACAC,IAAAA,WACAC,IAAAA,UACGC,oIAEH,OACEC,yBACEF,UAAWG,KAAMZ,EAAMO,GAAeP,OAAOO,EAAYE,GACzDI,KAAK,SACLC,YAAU,SACVC,kBAAoBf,WACpBgB,mBAAqBhB,kBACjBU,GAEJC,uBACEE,KAAK,WACLJ,UAAcT,gBACdiB,SAAS,IACTC,IAAKV,GAELG,sBAAIQ,GAAOnB,WAAYS,UAAcT,aAClCC,GAEHU,uBAAKQ,GAAOnB,iBAAkBS,UAAcT,mBACzCE,GAGHS,uBAAKF,UAAcT,oBAChBI,GACCO,0BACEF,UAAcT,cAAcA,mBAC5BoB,KAAK,SACLC,QAASf,GAERF,GAGJD,GACCQ,0BACEF,UAAcT,cAAcA,oBAC5BoB,KAAK,SACLC,QAAShB,GAERF,eC5DSmB,aACtBvB,UAAWC,aAAK,mBAChBuB,IAAAA,KACAC,IAAAA,OACAC,IAAAA,cACAC,UAAaC,IAAAA,MAAOC,IAAAA,KACpBC,IAAAA,KACGnB,oEAEH,OAAIc,OAIFb,gBAACb,KACCC,UAAWC,EACXK,QAAS,kBAAMoB,EAAUE,IACzBrB,OAAQ,kBAAMmB,EAAUG,IACxB3B,MAAOsB,EAAK,SACZpB,iBAAkBoB,EAAK,SACvBnB,gBAAiBmB,EAAK,SAClBb,GAEHmB,GACClB,yBACGY,EAAK,QAAS,IACfZ,qBAAGmB,KAAMP,EAAK,eAAgBd,UAAWG,EAAMZ,aAC5CuB,EAAK,eC/BH,SAASQ,EAAaC,EAAUC,GAC7C,GAAIA,EAAKC,OAASF,EAChB,MAAM,IAAIG,UAAUH,EAAW,aAAeA,EAAW,EAAI,IAAM,IAAM,uBAAyBC,EAAKC,OAAS,YC8BrG,SAASE,EAAOC,GAC7BN,EAAa,EAAGO,WAChB,IAAIC,EAASC,OAAOC,UAAUC,SAASC,KAAKN,GAE5C,OAAIA,aAAoBO,MAA4B,iBAAbP,GAAoC,kBAAXE,EAEvD,IAAIK,KAAKP,EAASQ,WACI,iBAAbR,GAAoC,oBAAXE,EAClC,IAAIK,KAAKP,IAES,iBAAbA,GAAoC,oBAAXE,GAAoD,oBAAZO,UAE3EA,QAAQC,KAAK,+IAEbD,QAAQC,MAAK,IAAIC,OAAQC,QAGpB,IAAIL,KAAKM,MCrBL,SAASC,EAA2BC,EAAeC,GAChEtB,EAAa,EAAGO,WAChB,IAAIgB,EAAWlB,EAAOgB,GAClBG,EAAYnB,EAAOiB,GACnBG,EAAWF,EAASG,cAAgBF,EAAUE,cAC9CC,EAAYJ,EAASK,WAAaJ,EAAUI,WAChD,OAAkB,GAAXH,EAAgBE,ECKV,SAASE,EAAWR,EAAeC,GAChDtB,EAAa,EAAGO,WAChB,IAAIgB,EAAWlB,EAAOgB,GAClBG,EAAYnB,EAAOiB,GACnBQ,EAAOP,EAAST,UAAYU,EAAUV,UAE1C,OAAIgB,EAAO,GACD,EACCA,EAAO,EACT,EAEAA,MC1CPC,EACAC,EACAC,EAEAC,EAEAC,EACA7D,EACAC,EACA6D,EACAC,EClBSC,EAAiB,qBAEjBC,EAAW,CACtBC,UAAWC,OAAOC,eAClBX,UAAWU,OAAOE,gBAIPC,EAAgB,CAC3BC,YAAa,ICPFC,EAAgB,SAACC,EAAK1D,UACjC0D,KACE1D,GAAQA,IAASiD,MACjBC,EAASC,WACTD,EAASC,UAAUQ,KAAK,SAACC,UAAYA,EAAQC,KAAKH,SAClDR,EAASR,WACTQ,EAASR,UAAUoB,MAAM,SAACF,UAAaA,EAAQC,KAAKH,OAE3CK,EAAkB,SAAUC,GACvC,IAAMN,EAAMM,EAAOC,aAAa,OAChC,OACGf,EAASC,WACRD,EAASC,UAAUW,MAAM,SAACI,UAAWA,EAAML,KAAKH,MACjDR,EAASR,WAAaQ,EAASR,UAAUiB,KAAK,SAACO,UAAUA,EAAML,KAAKH,MCX5DS,EAAW,IAAIC,iBAAiB,SAACC,GAC5C,IAAK,IAAIC,EAAI,EAAGA,EAAID,EAAUvD,OAAQwD,IAEpC,QADQC,EAAeF,EAAUC,GAAzBC,sBACCD,GACP,IAAME,EAAOD,EAAWD,GAEF,IAAlBE,EAAKC,UAAmC,WAAjBD,EAAKE,SAI1BjB,EAHQe,EAAKd,IACJc,EAAKxE,QAIhBuD,EAAcC,YAAYmB,KAAK,CAACH,EAAMA,EAAKxE,OAG3CwE,EAAKxE,KAAOiD,EAYZuB,EAAKI,iBACH,sBAVkC,SAA9BC,EAAwCC,GAExCN,EAAKP,aAAa,UAAYhB,GAChC6B,EAAMC,iBACRP,EAAKQ,oBACH,sBACAH,KASJL,EAAKS,eAAiBT,EAAKS,cAAcC,YAAYV,KA9BlDF,EAAI,EAAGA,EAAIC,EAAWzD,OAAQwD,MAA9BA,KCJPa,EAAsBC,SAASC,cAE/BC,EAAsB,CAC1B5B,IAAKtC,OAAOmE,yBAAyBC,kBAAkBnE,UAAW,OAClErB,KAAMoB,OAAOmE,yBAAyBC,kBAAkBnE,UAAW,SCD/DoE,EAAsB,IAAIC,OAAO,sBAAuB,KLK1DC,EAAkB,CAAEC,sTAAIC,qSAExBC,GAAU,EAMVC,EAAmBxG,EAAMyG,YA4CvBC,EAAe,CACnB7F,OAAQ,KACR8F,WAAY,MAed,SAASC,EAASC,EAAOC,GACvBC,aAAaC,QA5DW,4BA4DgBC,KAAKC,UAAUL,IACvDM,EAAcL,GAGhB,SAASM,UAjBT,WACE,IAAIC,EAAaN,aAAaO,QAhDN,6BAiDxB,GAAID,EACF,IACE,OAAOJ,KAAKM,MAAMF,IAAeX,EACjC,SACA,OAAOA,EAGX,OAAOA,EASwBc,GAAvB3G,IAAAA,OAAQ8F,IAAAA,WAChB,OACY,MAAV9F,GM7DW,SAA4B4B,EAAeC,GACxDtB,EAAa,EAAGO,WAChB,IAAIgB,EAAWlB,EAAOgB,GAClBG,EAAYnB,EAAOiB,GACnB+E,EAAOxE,EAAWN,EAAUC,GAC5B8E,EAAaC,KAAKC,IAAIpF,EAA2BG,EAAUC,IAC/DD,EAASkF,SAASlF,EAASK,WAAayE,EAAOC,GAG/C,IAAII,EAAqB7E,EAAWN,EAAUC,MAAgB6E,EAC1DM,EAASN,GAAQC,EAAaI,GAElC,OAAkB,IAAXC,EAAe,EAAIA,ENkDxBC,CAAmB,IAAI/F,KAAQ,IAAIA,KAAK0E,IAAe,GAEhD9F,OAKX,SAASC,EAAUD,EAAQiG,GACzBF,EACE,CACE/F,OAAAA,EACA8F,YAAY,IAAI1E,MAAOgG,eAEzBnB,GAEFvD,EAAS1C,GAlFG,UAmFRA,EACFnB,IACmB,MAAVmB,GACTlB,IAIJ,SAASwH,EAAcL,GA1FT,UA2FCM,MAgCRb,IKxIgB,eAAa2B,2BAC9BA,EAAoB3G,OAAS,GAC/BoC,EAASC,UAAY,GACrBD,EAASR,UAAY,KAEjBQ,EAASC,YACXD,EAASC,UAAYD,EAASC,UAAUuE,OAAO,SAAC9D,UAC9C6D,EAAoB3D,MAAM,SAAC6D,GACzB,MAA2B,iBAAhBA,GACD/D,EAAQC,KAAK8D,GACdA,aAAuBjC,OACvB9B,EAAQtC,aAAeqG,EAAYrG,uBAI9C4B,EAASR,YACXQ,EAASR,oBACJQ,EAASR,UACT+E,EACAG,IAAI,SAACD,GACJ,GAA2B,iBAAhBA,EAA0B,CACnC,IAIME,EAAmB,KAJNF,EAAYG,QAC7BrC,EACA,QAE2C,KAC7C,GACEvC,EAASR,UAAUoB,MACjB,SAACiE,UAAMA,EAAEzG,aAAeuG,EAAiBvG,aAG3C,WAAWoE,OAAOmC,WAEXF,aAAuBjC,QAE9BxC,EAASR,UAAUoB,MACjB,SAACiE,UAAMA,EAAEzG,aAAeqG,EAAYrG,aAGtC,OAAOqG,EAGX,cAEDD,OAAOM,YAOhB,IADA,IAAMC,EAAO7C,SAAS8C,sDACb5D,EAAI,EAAGA,EAAI2D,EAAKnH,OAAQwD,IAAK,CACpC,IAAMN,EAASiE,EAAK3D,GAChBP,EAAgBC,KAClBT,EAAcC,YAAYmB,KAAK,CAACX,EAAQ,2BACxCA,EAAOiB,cAAcC,YAAYlB,IAKrC,IAAImE,EAAc,EAClB,UAAI5E,EAAcC,aAAa4E,QAAQ,WAAiBC,OAAfrE,OAAQhE,OAC/C,GAAI+D,EAAgBC,GAAS,CAC3B,IAAMsE,EAAalD,SAASC,cAAc,UAG1C,IAAK,IAAIkD,KAFTD,EAAWE,aAAa,MAAOxE,EAAON,KACtC4E,EAAWE,aAAa,OAAQxI,GAAQ,0BACxBgE,EACVuE,EAAIE,WAAW,QACjBH,EAAWC,GAAOvE,EAAOuE,IAG7BnD,SAASsD,KAAKC,YAAYL,GAC1B/E,EAAcC,YAAYoF,OAAOP,EAAQF,EAAa,GACtDA,OAKAjF,EAASC,WAAaD,EAASC,UAAUrC,OAAS,GACpDqD,EAAS0E,aL4DXC,GACAhD,GAAU,GAjCR/C,KAEFgG,EAAa1C,GAkCf,SAASlG,EAAKoI,GACZ,OAAO1F,EAAS0F,GAGlB,SAASS,EAAWC,GAClB,MAAiC,iBAAtBA,EACF7D,SAAS8D,cAAcD,GAEzBA,EAWT,SAASF,EAAa1C,GACpB8C,EAASC,OACP7J,gBAACW,KACCC,KAAMA,EACNC,OAAQuG,IACRtG,UAAWA,EACXC,UAAW,CAAEC,MA3JL,QA2JYC,KA1Jb,QA2JPpB,WAAY2G,GACR/C,IAfDgG,EAAWpG,GAkBhByD,GAaJ,SAASgD,IACPlD,EAAS,KAAM,WACTJ,EAAiBuD,SACnBvD,EAAiBuD,QAAQC,wBAhLjB,qBACD,iCAFa,yCAM1B,SAAcC,EAASnD,GACrB3D,EAAY8G,EAAQ9G,WAAa,GACjCC,EAAuB6G,EAAQC,cALF,2BAM7B,IAAIC,EAAkBF,EAAQE,iBALX,KAMnB7G,OACM8C,EAAgB+D,IAAoB/D,EAAe,GAClD6D,EAAQ3G,UAAY2G,EAAQ3G,SAAS6G,IAAqB,IAEjE5G,EAAW0G,EAAQ1G,UAAa,aAChC7D,EAAUuK,EAAQvK,SAAY,aAC9BC,EAASsK,EAAQtK,QAAW,aAC5B6D,EAAmByG,EAAQzG,kBAAqB,aAChDC,KACErE,UAAW6K,EAAQ7K,WAAa,iBAChCQ,SAAUqK,EAAQrK,UAAY,eAC3BqK,EAAQxG,gBApBD,UAsBC2D,MA8ETb,IAKA1C,OAAOuG,SAASC,QAClBlH,EAAUiC,KAAQvB,OAAOuG,SAASC,0CO1HU,KAAzBzG,IAAAA,UAAWT,IAAAA,UAChCQ,EAASC,WAAaD,EAASC,WAAaA,cACtCD,EAASC,WAAa,GACtBA,GAAa,IAEnBD,EAASR,WAAaQ,EAASR,WAAaA,cACtCQ,EAASR,WAAa,GACtBA,GAAa,IJiCnByB,EAAS0F,QAAQzE,SAAS0E,gBAAiB,CACzCC,WAAW,EACXC,SAAS,ICpCX5E,SAASC,cAAgB,eAAaxE,2BAEpC,GAA8B,WAA1BA,EAAK,GAAGoJ,cACV,OAAO9E,EAAoB+E,KAAK9E,uBAAavE,GAE/C,IAAMsJ,EAAYhF,EAAoB+E,KAAK9E,uBAAavE,GAGxD,IACEO,OAAOgJ,iBAAiBD,EAAW,CACjCzG,IAAK,CACH2G,eACE,OAAO/E,EAAoB5B,IAAI2G,IAAI9I,KAAK+I,OAE1CC,aAAInE,GACE3C,EAAc2C,EAAO+D,EAAUnK,OACjCsF,EAAoBtF,KAAKuK,IAAIhJ,KAAK+I,KAAMrH,GAE1CqC,EAAoB5B,IAAI6G,IAAIhJ,KAAK+I,KAAMlE,KAG3CpG,KAAM,CACJuK,aAAInE,GACF,IAAMoE,EAAY/G,EAAc0G,EAAUzG,IAAKyG,EAAUnK,MACrDiD,EACAmD,EACJd,EAAoBtF,KAAKuK,IAAIhJ,KAAK+I,KAAME,OAM9CL,EAAU3B,aAAe,SAAUiC,EAAMrE,GAC1B,SAATqE,GAA4B,QAATA,EAAgBN,EAAUM,GAAQrE,EAEvDZ,kBAAkBnE,UAAUmH,aAAajH,KAAK4I,EAAWM,EAAMrE,IAEnE,MAAOsE,GAEPhJ,QAAQC,KACN,2DACAwI,EAAUzG,IACV,MACA,4IAGJ,OAAOyG,GJiFTrB,CAAU,CAAEpG,UAPZA,EAAYA,EAAUkF,IAAI,SAAU+C,GAClC,WAAWjF,WACLiF,EAAO7C,QAAQ,qBAAsB,QAAQA,QAAQ,MAAO,eAOpEhC,GAAU,IA7FVV,SAASR,iBAAiB,mBAAoB,WA0IhD,IACMgG,EA1IGhI,IACHA,EAA0BwC,SAASC,cAAc,OACjDD,SAASyF,KAAKlC,YAAY/F,KAwI1BgI,EAnBG5B,EAAWrG,KAqBhBiI,EAAQhG,iBAAiB,QAAS,WAChCyE,MAxIFN,EAAa1C,KAEfjD,OAAOwB,iBAAiB,UAAW,SAACE,GACjB,MAAbA,EAAMyD,KApCY,8BAoCGzD,EAAMyD,KAC7B7B"}